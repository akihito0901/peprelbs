<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PePre (ペプレ) - 愛犬との暮らしを、もっと美しく。</title>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts: Shippori Mincho for elegance, Zen Maru Gothic for rounded softness -->
    <link
        href="https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@400;500;700&family=Zen+Maru+Gothic:wght@300;400;500;700&display=swap"
        rel="stylesheet">

    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        theme: {
                            base: '#FFFBF5',      // Warm White
                            text: '#4A4238',      // Warm Dark Gray
                            primary: '#E5B5A8',   // Dusty Pink (Main Accent)
                            secondary: '#A8C8BA', // Sage Green (Health/Healing)
                            accent: '#DBC1AC',    // Sand/Greige (Neutral Accent)
                            surface: '#FFFFFF',   // Pure White
                            muted: '#F2EBE5'      // Muted background
                        }
                    },
                    fontFamily: {
                        sans: ['Zen Maru Gothic', 'sans-serif'],
                        serif: ['Shippori Mincho', 'serif'],
                    },
                    boxShadow: {
                        'soft': '0 4px 20px -2px rgba(229, 181, 168, 0.15)',
                        'float': '0 10px 30px -5px rgba(74, 66, 56, 0.05)',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #FFFBF5;
            color: #4A4238;
            -webkit-tap-highlight-color: transparent;
        }

        .font-serif {
            font-family: 'Shippori Mincho', serif;
        }

        .font-sans {
            font-family: 'Zen Maru Gothic', sans-serif;
        }

        .fade-in {
            animation: fadeIn 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards;
            opacity: 0;
            transform: translateY(10px);
        }

        .fade-in-delay-1 {
            animation-delay: 0.1s;
        }

        .fade-in-delay-2 {
            animation-delay: 0.2s;
        }

        .fade-in-delay-3 {
            animation-delay: 0.3s;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Hide scrollbar */
        .hide-scroll::-webkit-scrollbar {
            display: none;
        }

        .hide-scroll {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Custom styling for inputs */
        .input-underline {
            background: transparent;
            border-bottom: 1px solid #DBC1AC;
            transition: all 0.3s ease;
        }

        .input-underline:focus {
            border-color: #E5B5A8;
            outline: none;
        }
    </style>
</head>

<body class="bg-theme-base text-theme-text font-sans antialiased">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // --- ICONS (Thin & Elegant) ---
        const IconHome = ({ active }) => <svg xmlns="http://www.w3.org/2000/svg" fill={active ? "currentColor" : "none"} viewBox="0 0 24 24" strokeWidth={1} stroke="currentColor" className="w-6 h-6"><path strokeLinecap="round" strokeLinejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" /></svg>;
        const IconRecord = ({ active }) => <svg xmlns="http://www.w3.org/2000/svg" fill={active ? "currentColor" : "none"} viewBox="0 0 24 24" strokeWidth={1} stroke="currentColor" className="w-6 h-6"><path strokeLinecap="round" strokeLinejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z" /></svg>;
        const IconEvent = ({ active }) => <svg xmlns="http://www.w3.org/2000/svg" fill={active ? "currentColor" : "none"} viewBox="0 0 24 24" strokeWidth={1} stroke="currentColor" className="w-6 h-6"><path strokeLinecap="round" strokeLinejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z" /></svg>;
        const IconLost = ({ active }) => <svg xmlns="http://www.w3.org/2000/svg" fill={active ? "currentColor" : "none"} viewBox="0 0 24 24" strokeWidth={1} stroke="currentColor" className="w-6 h-6"><path strokeLinecap="round" strokeLinejoin="round" d="M8.25 21v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21m0 0h4.5V3.545M12.75 21h7.5V10.75M2.25 21h1.5m18 0h-18M2.25 9l4.5-1.636M18.75 3l-1.5.545m0 6.205 3 1m1.5.5-1.5-.5M6.75 7.364V3h-3v18m3-13.636 10.5-3.819" /></svg>;

        const IconFood = () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-8 h-8 mb-2 text-theme-primary"><path strokeLinecap="round" strokeLinejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z" /></svg>;
        const IconHealth = () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-8 h-8 mb-2 text-theme-primary"><path strokeLinecap="round" strokeLinejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z" /></svg>; // Reusing Heart
        const IconEventNews = () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-8 h-8 mb-2 text-theme-primary"><path strokeLinecap="round" strokeLinejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z" /></svg>;
        const IconLostFound = () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-8 h-8 mb-2 text-theme-primary"><path strokeLinecap="round" strokeLinejoin="round" d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" /><path strokeLinecap="round" strokeLinejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z" /></svg>;

        const IconEye = () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5 text-theme-primary"><path strokeLinecap="round" strokeLinejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" /><path strokeLinecap="round" strokeLinejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" /></svg>;
        const IconCoat = () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5 text-theme-primary"><path strokeLinecap="round" strokeLinejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z" /></svg>;
        const IconBone = () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5 text-theme-primary"><path strokeLinecap="round" strokeLinejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" /></svg>; // Simulating bone with search... actually wait, let's use a nice shape
        const IconWeight = () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5 text-theme-primary"><path strokeLinecap="round" strokeLinejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" /></svg>; // Scale like
        const IconBowl = () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5 text-theme-primary"><path strokeLinecap="round" strokeLinejoin="round" d="M15.182 15.182a4.5 4.5 0 0 1-6.364 0M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0ZM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Z" /></svg>;
        const IconCheck = () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5 text-theme-primary"><path strokeLinecap="round" strokeLinejoin="round" d="M4.5 12.75l6 6 9-13.5" /></svg>;
        const IconPaw = () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-6 h-6 text-theme-primary"><path strokeLinecap="round" strokeLinejoin="round" d="M7.5 6a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM3.751 20.105a8.25 8.25 0 0 1 16.498 0 .75.75 0 0 1-.437.695A18.683 18.683 0 0 1 12 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 0 1-.437-.695Z" /></svg>; // Simple Paw/Face

        // --- DATA ---
        const PRODUCTS = [
            { id: 1, name: "ACANA - アカナ", tags: { age: 'all', concern: 'coat', priority: 'A', secondaryConcern: ['joints'] }, img: "./images/acana.jpg", description: "生物学的に適正な栄養。新鮮な肉類を最大75%使用し、筋肉と被毛をサポート。", price: "¥要確認", link: "https://px.a8.net/svt/ejp?a8mat=45GGT8+CWE66A+5FPU+61JSH", feature: "High Protein" },
            { id: 2, name: "Alan's Natural - アランズ", tags: { age: 'adult', concern: 'allergy', priority: 'A', secondaryConcern: ['tear_burn'] }, img: "./images/alans.jpg", description: "野生の食事を再現。ラム肉とサツマイモ、わずか9種の厳選素材。", price: "¥要確認", link: "https://px.a8.net/svt/ejp?a8mat=45GGT8+BDMAIQ+3J8+3H2YHD", feature: "Hypoallergenic" },
            { id: 4, name: "UMAKA - うまか", tags: { age: 'all', concern: 'tear_burn', priority: 'S', secondaryConcern: ['joints', 'digest'] }, img: "./images/umaka.jpg", description: "九州産「華味鳥」100%。涙やけと関節に配慮した、内側から溢れる美しさ。", price: "¥5,478", link: "http://msm.to/2U5R2J2", feature: "Premium Care" },
            { id: 5, name: "Essential - エッセンシャル", tags: { age: 'adult', concern: 'coat', priority: 'B', secondaryConcern: ['allergy'] }, img: "./images/essential.jpg", description: "お肉不使用、魚77.5%。アレルゲン排除とオメガ3で皮膚トラブルに特化。", price: "¥要確認", link: "https://px.a8.net/svt/ejp?a8mat=45GGT8+BDMAIQ+3J8+3H2YHD", feature: "Fish Based" },
            { id: 6, name: "Canagan - カナガン", tags: { age: 'all', concern: 'appetite', priority: 'S', secondaryConcern: ['active'] }, img: "./images/canagan.jpg", description: "世界中で愛されるグレインフリー。チキン60%の食いつきと栄養バランス。", price: "¥要確認", link: "https://px.a8.net/svt/ejp?a8mat=45GGT8+CWE66A+5FPU+61JSH", feature: "Grain Free" },
            { id: 7, name: "Canagan Dental - デンタル", tags: { age: 'all', concern: 'none', priority: 'A', secondaryConcern: ['appetite'] }, img: "./images/canagan_dental.jpg", description: "特許成分配合。食べるだけで愛犬の「口内の健康」を守る画期的フード。", price: "¥要確認", link: "https://px.a8.net/svt/ejp?a8mat=45GGT8+BQ4E82+3J8+5SG2LT", feature: "Oral Care" },
            { id: 8, name: "Canagan - チキン＆サーモン", tags: { age: 'all', concern: 'coat', priority: 'A', secondaryConcern: ['appetite'] }, img: "./images/canagan_chickensalmon.jpg", description: "チキンとサーモンの相乗効果。偏食対策と美しい毛並みの維持に。", price: "¥要確認", link: "https://px.a8.net/svt/ejp?a8mat=3ZJU37+EGYCN6+4NYE+61Z81", feature: "Multi Protein" },
            { id: 9, name: "GRANDS - グランツ", tags: { age: 'adult', concern: 'tear_burn', priority: 'B', secondaryConcern: ['allergy'] }, img: "./images/grands.jpg", description: "無添加・グレインフリー。小粒設計でお腹に優しいフランス産プレミアム。", price: "¥要確認", link: "http://msm.to/APkBGUm", feature: "Digest Support" },
            { id: 10, name: "GLEBO - グレボ", tags: { age: 'senior', concern: 'joints', priority: 'B', secondaryConcern: ['tear_burn'] }, img: "./images/glebo.jpg", description: "国産・関節ケア。抗酸化成分とグルコサミン配合でシニアの元気を維持。", price: "¥要確認", link: "http://msm.to/3OyO6nm", feature: "Anti-Aging" },
            { id: 11, name: "Konokono - このこのごはん", tags: { age: 'all', concern: 'tear_burn', priority: 'S', secondaryConcern: ['coat', 'odor'] }, img: "./images/konokono.jpg", description: "小型犬の「涙やけ・毛並み・におい」に特化。自然素材のやさしい国産ご飯。", price: "¥要確認", link: "http://msm.to/7C7CAGn", feature: "Tear Burn Care" },
            { id: 12, name: "Nelsons - ネルソンズ", tags: { age: 'adult', concern: 'appetite', priority: 'B', secondaryConcern: ['digest'] }, img: "./images/nelsons.jpg", description: "中型・大型犬向けの大容量。グレインフリーで消化と家計を両立。", price: "¥要確認", link: "https://px.a8.net/svt/ejp?a8mat=3HRCDC+2Z6SY+3J8+ZQ80I", feature: "Large Breed" },
            { id: 13, name: "Happy Dog - ハッピードッグ", tags: { age: 'all', concern: 'allergy', priority: 'B', secondaryConcern: ['obesity'] }, img: "./images/happydog.jpg", description: "ドイツ品質のナチュラルフード。珍しいタンパク源でアレルギーや体調管理に。", price: "¥要確認", link: "", feature: "German Quality" },
            { id: 14, name: "PETOKOTO - ペトコト", tags: { age: 'all', concern: 'appetite', priority: 'S', secondaryConcern: ['digest'] }, img: "./images/petokoto.jpg", description: "新鮮な食材を急速冷凍。手作りごはんの栄養と香りで、驚きの食いつきを。", price: "¥要確認", link: "https://px.a8.net/svt/ejp?a8mat=3ZJU37+EGYCN6+4NYE+61Z81", feature: "Fresh Food" },
            { id: 15, name: "Mishone - ミシュワン", tags: { age: 'adult', concern: 'joints', priority: 'S', secondaryConcern: ['tear_burn', 'coat'] }, img: "./images/mishone.jpg", description: "関節ケアの最高峰。緑イ貝配合で、いつまでも軽やかなステップを。", price: "¥4,378", link: "https://px.a8.net/svt/ejp?a8mat=45GGT8+C1FP16+4PA6+BXYE9", feature: "Joint Support" },
            { id: 16, name: "Mogcube - モグキューブ", tags: { age: 'active', concern: 'appetite', priority: 'B', secondaryConcern: [] }, img: "./images/mogcube.jpg", description: "NZ産ラムのフリーズドライ。栄養そのままでトッピングやおやつにも最適。", price: "¥要確認", link: "https://px.a8.net/svt/ejp?a8mat=3HQZ35+BN56NM+3J8+354KNM", feature: "Freeze Dried" },
            { id: 17, name: "Mogwan - モグワン", tags: { age: 'all', concern: 'tear_burn', priority: 'S', secondaryConcern: ['coat', 'appetite'] }, img: "./images/mogwan.jpg", description: "手作り食レシピの美味しさと栄養バランス。野菜とフルーツたっぷりの人気No.1。", price: "¥要確認", link: "https://px.a8.net/svt/ejp?a8mat=3ZJU37+EGYCN6+4NYE+61Z81", feature: "Best Seller" },
            { id: 18, name: "YAWAKA - やわか", tags: { age: 'senior', concern: 'appetite', priority: 'A', secondaryConcern: ['digest'] }, img: "./images/yawaka.jpg", description: "水分を逃さない特殊製法。シニアも食べやすい国産セミモイストフード。", price: "¥6,578", link: "http://msm.to/ApJikKQ", feature: "Soft Touch" },
            { id: 19, name: "Yurikago - ユリカゴ", tags: { age: 'all', concern: 'none', priority: 'B', secondaryConcern: [] }, img: "./images/yurikago.jpg", description: "「安眠」と「リラックス」をテーマに。ハーブの力で穏やかな毎日を。", price: "¥要確認", link: "https://px.a8.net/svt/ejp?a8mat=45GGT8+BQ4E82+3J8+5SG2LT", feature: "Relax Care" },
            { id: 20, name: "Baniku - 馬肉自然づくり", tags: { age: 'adult', concern: 'obesity', priority: 'A', secondaryConcern: ['allergy'] }, img: "./images/baniku.jpg", description: "熊本産馬肉を贅沢に使用。高タンパク・低脂質でダイエットに最適。", price: "¥要確認", link: "https://px.a8.net/svt/ejp?a8mat=3ZJU37+EGYCN6+4NYE+61Z81", feature: "Low Fat" },
            { id: 21, name: "Mirai - 和漢みらい", tags: { age: 'senior', concern: 'none', priority: 'A', secondaryConcern: ['obesity'] }, img: "./images/wakan.jpg", description: "89種類の和漢植物を配合。薬善の知恵でシニア期の健康を徹底サポート。", price: "¥要確認", link: "https://px.a8.net/svt/ejp?a8mat=45GGT8+BDMAIQ+3J8+3H2YHD", feature: "Yakuzen Care" }
        ];

        const BREEDS = {
            "あ": ["アーフェンピンシャー", "秋田", "アメリカンコッカー", "イタグレ", "ウィペット", "コーギー"],
            "か": ["キャバリア", "グレートピレニーズ", "ゴールデン"],
            "さ": ["サモエド", "シーズー", "シェルティ", "柴犬", "ハスキー"],
            "た": ["ダックス", "ダルメシアン", "チワワ", "トイプードル"],
            "は": ["パグ", "パピヨン", "ビーグル", "ビション", "ブルドッグ", "フレンチブル", "ボーダーコリー", "ポメラニアン"],
            "ま": ["マルチーズ", "Ｍシュナウザー", "Ｍダックス"],
            "や": ["ヨークシャーテリア"],
            "ら": ["ラブラドール"],
        };
        const BREED_TABS = Object.keys(BREEDS);

        const EVENTS_DATA = [
            { date: "Feb 14", title: "Wan Nyan Festival", place: "Tokyo, Toneri Park", tags: ["Outdoor", "Family"], img: "https://images.unsplash.com/photo-1548199973-03cce0bbc87b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" },
            { date: "Feb 21", title: "Chiba Winter Dog Fes", place: "Makuhari Messe", tags: ["Indoor", "Market"], img: "https://images.unsplash.com/photo-1516734212186-a967f81ad0d7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" },
            { date: "Feb 28", title: "Mizumoto Dog Park", place: "Mizumoto Park", tags: ["Marche", "Standard"], img: "https://images.unsplash.com/photo-1534361960057-19889db9621e?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" },
        ];

        const LOST_DATA = [
            { id: 1, name: "Pochi", breed: "Shiba Inu", place: "Shibuya, Tokyo", date: "2026/02/01", features: "Red Collar", img: "https://images.unsplash.com/photo-1583511655857-d19b40a7a54e?ixlib=rb-1.2.1&auto=format&fit=crop&w=200&q=60" },
            { id: 2, name: "Coco", breed: "Toy Poodle", place: "Kashiwa, Chiba", date: "2026/02/02", features: "Blue Harness", img: "https://images.unsplash.com/photo-1591769225440-811ad7d6eca6?ixlib=rb-1.2.1&auto=format&fit=crop&w=200&q=60" },
        ];

        // === COMPONENTS ===

        // --- 1. LANDING PAGE ---
        const LandingPage = ({ onLogin }) => {
            return (
                <div className="min-h-screen bg-theme-base flex flex-col items-center pb-20 fade-in relative pt-16">
                    {/* Logo (Restored & Centered) */}
                    <img src="./images/logo_line.png" className="w-40 mb-10 opacity-90 mix-blend-multiply" />

                    {/* Text Section (Clean Layout) */}
                    <div className="text-center px-6 mb-16 relative z-10 text-theme-text">
                        <h1 className="font-serif text-3xl md:text-4xl font-medium leading-relaxed tracking-wide drop-shadow-sm mb-6">
                            愛犬の管理、<br />スマホ一つで。
                        </h1>
                        <p className="text-sm text-theme-text/70 font-sans tracking-wider leading-loose">
                            フード診断、イベント情報、<br />ワクチン接種記録まで全て完結。
                        </p>
                    </div>

                    <div className="w-full max-w-md px-6 relative z-10 grid grid-cols-2 gap-x-4 gap-y-8 mb-16">
                        <FeatureCard
                            icon={<IconFood />}
                            title="Food Diagnosis"
                            jp="フード診断"
                            desc="年齢と体質に合わせた最適な一皿を提案"
                        />
                        <FeatureCard
                            icon={<IconHealth />}
                            title="Health Record"
                            jp="ヘルスケア記録"
                            desc="ワクチン接種日と次回予定を管理"
                        />
                        <FeatureCard
                            icon={<IconEventNews />}
                            title="Event News"
                            jp="イベント情報"
                            desc="週末のお出かけ先を全国から検索"
                        />
                        <FeatureCard
                            icon={<IconLostFound />}
                            title="Lost & Found"
                            jp="迷子掲示板"
                            desc="地域のみんなで守る安心ネットワーク"
                        />
                    </div>

                    {/* Google Login Section (Moved Below) */}
                    <div className="w-full max-w-xs px-6 mb-16">
                        <div className="text-center mb-6">
                            <p className="font-serif text-theme-text text-lg mb-1">さあ、始めましょう</p>
                            <p className="text-xs text-theme-text/50">登録も管理も、これひとつ。</p>
                        </div>
                        <button onClick={onLogin} className="w-full group relative overflow-hidden bg-white border border-theme-primary/30 text-theme-text font-serif px-6 py-5 rounded-2xl shadow-soft hover:shadow-card transition-all duration-300 active:scale-95 flex items-center justify-center gap-3">
                            <svg className="w-5 h-5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4" />
                                <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853" />
                                <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05" />
                                <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335" />
                            </svg>
                            <span className="tracking-widest font-bold text-sm">Googleでログイン</span>
                        </button>
                    </div>

                    <footer className="text-center text-[10px] text-theme-text/30 pb-8 font-sans">
                        © 2026 PePre Inc.
                    </footer>
                </div>
            );
        };

        const FeatureCard = ({ icon, title, jp, desc }) => (
            <div className="flex flex-col items-center text-center p-2">
                <div className="mb-2 p-3 bg-white/50 rounded-full text-theme-primary">
                    {icon}
                </div>
                <h3 className="font-serif text-base text-theme-text mb-1">{jp}</h3>
                <p className="text-[10px] text-theme-text/60 leading-relaxed font-sans">{desc}</p>
            </div>
        );


        // --- 2. DASHBOARD ---
        // --- 2. DASHBOARD ---
        const Dashboard = ({ onLogout }) => {
            const [tab, setTab] = useState('menu');
            const [answers, setAnswers] = useState(null); // Food Diagnosis
            const [dogProfile, setDogProfile] = useState(null); // Dog Registration (Name, Image, Age)
            const [isProfileOpen, setIsProfileOpen] = useState(false);

            // Load Simulation
            useEffect(() => {
                const saved = localStorage.getItem('pepre_data');
                if (saved) {
                    const data = JSON.parse(saved);
                    if (data.answers) setAnswers(data.answers);
                    if (data.dogProfile) setDogProfile(data.dogProfile);
                }
            }, []);

            // Save Simulation
            useEffect(() => {
                if (answers || dogProfile) {
                    localStorage.setItem('pepre_data', JSON.stringify({ answers, dogProfile }));
                }
            }, [answers, dogProfile]);

            const handleProfileSave = (profile) => {
                setDogProfile(profile);
                setIsProfileOpen(false);
            };

            const renderContent = () => {
                if (isProfileOpen) return <ProfileEditor current={dogProfile} onSave={handleProfileSave} onCancel={() => setIsProfileOpen(false)} />;

                switch (tab) {
                    case 'menu': return <HomeMenu onNavigate={setTab} profile={dogProfile} hasDiagnosis={!!answers} onEditProfile={() => setIsProfileOpen(true)} />;
                    case 'home': return answers ? <FoodResults answers={answers} onReset={() => setAnswers(null)} /> : <Diagnosis onResult={setAnswers} />;
                    case 'record': return <RecordTab />;
                    case 'event': return <EventsTab />;
                    case 'lost': return <LostTab />;
                    default: return <HomeMenu onNavigate={setTab} profile={dogProfile} hasDiagnosis={!!answers} onEditProfile={() => setIsProfileOpen(true)} />;
                }
            };

            return (
                <div className="min-h-screen bg-theme-base pb-24 fade-in">
                    <header className="fixed top-0 w-full max-w-md mx-auto z-40 bg-theme-base/80 backdrop-blur-md px-6 py-4 flex justify-between items-center shadow-sm">
                        <span onClick={() => { setTab('menu'); setIsProfileOpen(false); }} className="font-serif text-2xl tracking-widest text-theme-text font-medium cursor-pointer">PePre</span>
                        <div className="flex items-center gap-4">
                            <button onClick={() => setIsProfileOpen(true)} className="w-8 h-8 rounded-full bg-theme-muted overflow-hidden border border-theme-text/10">
                                {dogProfile?.image ? <img src={dogProfile.image} className="w-full h-full object-cover" /> : <div className="w-full h-full flex items-center justify-center text-theme-text/30"><IconPaw /></div>}
                            </button>
                            <button onClick={onLogout} className="text-xs text-theme-text/50 hover:text-theme-primary transition-colors">Log out</button>
                        </div>
                    </header>
                    <main className="pt-20 px-6">
                        {renderContent()}
                    </main>
                    <nav className="fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-white/90 backdrop-blur-lg border-t border-theme-muted flex justify-around py-2 pb-safe z-50">
                        <NavButton active={tab === 'menu'} onClick={() => { setTab('menu'); setIsProfileOpen(false); }} icon={<IconHome active={tab === 'menu'} />} label="ホーム" />
                        <NavButton active={tab === 'record'} onClick={() => { setTab('record'); setIsProfileOpen(false); }} icon={<IconRecord active={tab === 'record'} />} label="記録" />
                        <NavButton active={tab === 'event'} onClick={() => { setTab('event'); setIsProfileOpen(false); }} icon={<IconEvent active={tab === 'event'} />} label="イベント" />
                        <NavButton active={tab === 'lost'} onClick={() => { setTab('lost'); setIsProfileOpen(false); }} icon={<IconLost active={tab === 'lost'} />} label="迷子" />
                    </nav>
                </div>
            );
        };

        const ProfileEditor = ({ current, onSave, onCancel }) => {
            const [name, setName] = useState(current?.name || '');
            const [breed, setBreed] = useState(current?.breed || '');
            const [age, setAge] = useState(current?.age || '');
            const [image, setImage] = useState(current?.image || null);

            const handleImageConfig = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => setImage(reader.result);
                    reader.readAsDataURL(file);
                }
            };

            return (
                <div className="fade-in">
                    <div className="text-center mb-6">
                        <h2 className="font-serif text-xl text-theme-text mb-2">My Partner</h2>
                        <p className="text-xs text-theme-text/60">愛犬の情報を登録・編集します</p>
                    </div>

                    <div className="flex flex-col gap-6">
                        {/* Image Upload */}
                        <div className="flex justify-center">
                            <label className="relative w-28 h-28 rounded-full bg-theme-muted border-2 border-theme-muted overflow-hidden flex items-center justify-center cursor-pointer shadow-inner">
                                {image ? <img src={image} className="w-full h-full object-cover" /> : <IconPaw />}
                                <div className="absolute inset-0 bg-black/20 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity">
                                    <span className="text-[10px] text-white font-bold bg-black/50 px-2 py-1 rounded">CHANGE</span>
                                </div>
                                <input type="file" accept="image/*" className="hidden" onChange={handleImageConfig} />
                            </label>
                        </div>

                        {/* Fields */}
                        <div className="space-y-4">
                            <div>
                                <label className="block text-xs font-bold text-theme-text/50 mb-1 tracking-widest uppercase">Name</label>
                                <input type="text" value={name} onChange={e => setName(e.target.value)} placeholder="お名前" className="w-full p-4 rounded-xl bg-white border border-theme-muted outline-none focus:border-theme-primary transition-colors text-theme-text" />
                            </div>
                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-xs font-bold text-theme-text/50 mb-1 tracking-widest uppercase">Breed</label>
                                    <input type="text" value={breed} onChange={e => setBreed(e.target.value)} placeholder="犬種" className="w-full p-4 rounded-xl bg-white border border-theme-muted outline-none focus:border-theme-primary transition-colors text-theme-text" />
                                </div>
                                <div>
                                    <label className="block text-xs font-bold text-theme-text/50 mb-1 tracking-widest uppercase">Age</label>
                                    <input type="text" value={age} onChange={e => setAge(e.target.value)} placeholder="年齢" className="w-full p-4 rounded-xl bg-white border border-theme-muted outline-none focus:border-theme-primary transition-colors text-theme-text" />
                                </div>
                            </div>
                        </div>

                        {/* Actions */}
                        <button onClick={() => onSave({ name, breed, age, image })} className="w-full py-4 bg-theme-primary text-white rounded-xl shadow-lg hover:brightness-110 transition-all font-serif tracking-widest mt-4">
                            SAVE PROFILE
                        </button>
                        <button onClick={onCancel} className="w-full py-3 text-theme-text/50 text-xs tracking-widest hover:text-theme-text transition-colors">
                            CANCEL
                        </button>
                    </div>
                </div>
            );
        };

        const HomeMenu = ({ onNavigate, profile, hasDiagnosis, onEditProfile }) => (
            <div className="flex flex-col gap-6 fade-in">
                {/* Profile Header simulated in Menu */}
                <div onClick={onEditProfile} className="bg-white p-6 rounded-3xl shadow-sm border border-theme-muted/50 flex items-center gap-4 cursor-pointer hover:shadow-soft transition-all">
                    <div className="w-16 h-16 rounded-full bg-theme-muted overflow-hidden flex-shrink-0 border border-theme-text/5">
                        {profile?.image ? <img src={profile.image} className="w-full h-full object-cover" /> : <div className="w-full h-full flex items-center justify-center text-theme-text/20 scale-150"><IconPaw /></div>}
                    </div>
                    <div className="flex-1">
                        <h2 className="font-serif text-xl text-theme-text">{profile?.name || "No Name"}</h2>
                        <p className="text-xs text-theme-text/50">{profile?.breed ? `${profile.breed} / ${profile.age}歳` : "プロフィール未登録"}</p>
                    </div>
                    <div className="text-theme-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5"><path strokeLinecap="round" strokeLinejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" /></svg>
                    </div>
                </div>

                <div className="grid grid-cols-2 gap-4">
                    <MenuButton
                        onClick={() => onNavigate('home')}
                        icon={<IconFood />}
                        title="フード診断"
                        desc={hasDiagnosis ? "診断結果" : "未診断"}
                        accent={!hasDiagnosis}
                    />
                    <MenuButton onClick={() => onNavigate('record')} icon={<IconHealth />} title="ヘルスケア" desc="0 Records" />
                    <MenuButton onClick={() => onNavigate('event')} icon={<IconEventNews />} title="イベント" desc="New 3" />
                    <MenuButton onClick={() => onNavigate('lost')} icon={<IconLostFound />} title="迷子掲示板" desc="Safe" />
                </div>
            </div>
        );

        const MenuButton = ({ onClick, icon, title, desc, accent }) => (
            <button onClick={onClick} className={`p-6 rounded-3xl text-center flex flex-col items-center gap-3 transition-all duration-300 active:scale-95 group ${accent ? 'bg-theme-text text-white shadow-lg' : 'bg-white text-theme-text shadow-sm hover:shadow-soft'}`}>
                <div className={`p-3 rounded-full ${accent ? 'bg-white/10' : 'bg-theme-muted/50 text-theme-primary'}`}>
                    {React.cloneElement(icon, { className: `w-8 h-8 ${accent ? 'text-white' : 'text-theme-primary'}` })}
                </div>
                <div>
                    <h3 className="font-serif text-base mb-1">{title}</h3>
                    <p className={`text-[10px] ${accent ? 'text-white/60' : 'text-theme-text/40'}`}>{desc}</p>
                </div>
            </button>
        );

        const NavButton = ({ active, onClick, icon, label }) => (
            <button onClick={onClick} className={`flex flex-col items-center gap-1 w-16 py-2 transition-all duration-500 ${active ? 'text-theme-primary' : 'text-theme-text/30'}`}>
                {icon}
                <span className="text-[10px] font-medium">{label}</span>
            </button>
        );

        // --- DASHBOARD SUB-COMPONENTS (Refined) ---
        const Diagnosis = ({ onResult }) => {
            const [step, setStep] = useState(0);
            const [answers, setAnswers] = useState({});
            const [breedTab, setBreedTab] = useState(BREED_TABS[0]);

            const submit = (key, val) => {
                const next = { ...answers, [key]: val };
                setAnswers(next);
                key === 'concern' ? onResult(next) : setStep(s => s + 1);
            };

            const steps = [
                { t: "犬種をお選びください", c: <BreedSelector tab={breedTab} setTab={setBreedTab} submit={submit} /> },
                { t: "年齢のステージは？", c: <AgeSelector submit={submit} /> },
                { t: "気になることはありますか？", c: <ConcernSelector submit={submit} /> },
            ];

            return (
                <div className="h-full flex flex-col pt-4 fade-in">
                    <div className="text-center mb-10">
                        <h2 className="text-xl font-serif text-theme-text">{steps[step].t}</h2>
                    </div>
                    {steps[step].c}
                </div>
            );
        };

        const BreedSelector = ({ tab, setTab, submit }) => (
            <div className="flex flex-col">
                <div className="flex gap-4 overflow-x-auto pb-4 mb-4 hide-scroll px-1">
                    {BREED_TABS.map(t => <button key={t} onClick={() => setTab(t)} className={`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center text-sm font-serif transition-all duration-300 ${tab === t ? 'bg-theme-text text-theme-base shadow-lg scale-110' : 'bg-white text-theme-text/50'}`}>{t}</button>)}
                </div>
                <div className="grid grid-cols-2 gap-3 pb-20">
                    {BREEDS[tab].map(b => <button key={b} onClick={() => submit('breed', b)} className="p-4 text-center text-sm bg-white rounded-xl shadow-sm text-theme-text hover:shadow-soft transition-all">{b}</button>)}
                </div>
            </div>
        );

        const AgeSelector = ({ submit }) => (
            <div className="space-y-4">
                {[{ l: "Puppy", jp: "子犬", sub: "〜1歳" }, { l: "Adult", jp: "成犬", sub: "1〜7歳" }, { l: "Senior", jp: "シニア", sub: "7歳〜" }]
                    .map(o => (
                        <button key={o.l} onClick={() => submit('age', o.l)} className="w-full bg-white p-6 rounded-2xl shadow-sm hover:shadow-soft transition-all duration-300 group text-left flex justify-between items-center">
                            <div className="flex items-center gap-4">
                                <IconPaw />
                                <span className="font-serif text-lg text-theme-text">{o.jp}</span>
                            </div>
                            <span className="text-xs text-theme-text/30 font-sans">{o.sub}</span>
                        </button>
                    ))}
            </div>
        );

        const ConcernSelector = ({ submit }) => (
            <div className="grid grid-cols-2 gap-3">
                {[{ l: "Tear Burn", jp: "涙やけ", v: 'tear_burn', icon: <IconEye /> }, { l: "Coat", jp: "毛並み", v: 'coat', icon: <IconCoat /> }, { l: "Joints", jp: "関節", v: 'joints', icon: <IconBone /> }, { l: "Weight", jp: "体重管理", v: 'obesity', icon: <IconWeight /> }, { l: "Appetite", jp: "食いつき", v: 'appetite', icon: <IconBowl /> }, { l: "Nothing", jp: "特になし", v: 'none', icon: <IconCheck /> }]
                    .map(o => (
                        <button key={o.v} onClick={() => submit('concern', [o.v])} className="aspect-square bg-white rounded-2xl flex flex-col items-center justify-center gap-2 shadow-sm hover:shadow-soft transition-all active:scale-95">
                            {o.icon}
                            <span className="font-serif text-theme-text">{o.jp}</span>
                        </button>
                    ))}
            </div>
        );

        const FoodResults = ({ answers, onReset }) => {
            const results = useMemo(() => {
                if (!answers) return [];
                const userAge = answers.age || 'Adult'; // Default
                const userConcerns = answers.concern || []; // Array

                return PRODUCTS
                    .map(p => {
                        let score = 0;
                        // 1. Quality/Priority (User Satisfaction)
                        if (p.tags.priority === 'S') score += 50;
                        if (p.tags.priority === 'A') score += 30;
                        if (p.tags.priority === 'B') score += 10;

                        // 2. Age Match
                        const pAge = p.tags.age;
                        let isAgeMatch = false;
                        if (pAge === 'all') isAgeMatch = true;
                        else if (pAge.toLowerCase() === userAge.toLowerCase()) isAgeMatch = true;

                        if (!isAgeMatch) return null; // Filter out mismatched age

                        // 3. Concern Match
                        if (userConcerns.includes(p.tags.concern)) score += 40;
                        const secondaryMatch = p.tags.secondaryConcern.some(c => userConcerns.includes(c));
                        if (secondaryMatch) score += 20;

                        return { ...p, score };
                    })
                    .filter(Boolean) // Remove nulls
                    .sort((a, b) => b.score - a.score)
                    .slice(0, 3);
            }, [answers]);

            return (
                <div className="pb-24 fade-in">
                    <div className="text-center mb-8">
                        <p className="font-serif text-lg mb-2">My Best Selection</p>
                        <p className="text-xs text-theme-text/50 font-sans">
                            {answers.breed} / {answers.age === 'Puppy' ? '子犬' : answers.age === 'Senior' ? 'シニア' : '成犬'}
                            <br />
                            <span className="text-[10px] mt-1 inline-block bg-theme-muted px-2 py-0.5 rounded-full">
                                Priority: Quality & Satisfaction
                            </span>
                        </p>
                    </div>
                    <div className="space-y-8">
                        {results.map((p, i) => (
                            <div key={p.id} className="group cursor-pointer" onClick={() => p.link && window.open(p.link, '_blank')}>
                                <div className="relative aspect-[4/3] rounded-2xl overflow-hidden mb-4 shadow-float">
                                    <div className="absolute top-4 left-4 bg-white/90 backdrop-blur px-3 py-1 rounded-full z-10">
                                        <span className="text-[10px] font-bold tracking-widest uppercase text-theme-text">No.0{i + 1} Match</span>
                                    </div>
                                    {p.tags.priority === 'S' && (
                                        <div className="absolute top-4 right-4 bg-theme-primary/90 backdrop-blur px-3 py-1 rounded-full z-10 text-white">
                                            <span className="text-[10px] font-bold tracking-widest uppercase">Premium</span>
                                        </div>
                                    )}
                                    <img src={p.img} className="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" />
                                </div>
                                <div className="text-center px-2">
                                    <span className="text-[10px] text-theme-primary tracking-widest uppercase block mb-2">{p.feature}</span>
                                    <h3 className="font-serif text-xl text-theme-text mb-2">{p.name}</h3>
                                    <p className="text-sm text-theme-text/60 leading-relaxed mb-3">{p.description}</p>
                                    {/* Price less prominent as requested */}
                                    <p className="text-xs text-theme-text/40 mb-4 font-sans border-b border-transparent inline-block group-hover:border-theme-primary/30 transition-all">Go to Official Site</p>

                                    <button className="w-full bg-theme-text text-white text-xs px-6 py-4 rounded-xl shadow-lg hover:bg-theme-text/90 transition-all uppercase tracking-widest">
                                        公式サイトを見る
                                    </button>
                                </div>
                            </div>
                        ))}
                    </div>
                    <button onClick={onReset} className="w-full mt-12 text-xs text-theme-text/40 tracking-widest uppercase hover:text-theme-primary transition-colors">もう一度診断する</button>
                </div>
            );
        };

        const RecordTab = () => {
            const [lastDate, setLastDate] = useState(localStorage.getItem('pepre_vaccine_date') || '');
            const handleSave = (e) => { setLastDate(e.target.value); localStorage.setItem('pepre_vaccine_date', e.target.value); };
            const nextDate = useMemo(() => {
                if (!lastDate) return null;
                const d = new Date(lastDate);
                d.setFullYear(d.getFullYear() + 1);
                return d.toLocaleDateString();
            }, [lastDate]);
            return (
                <div className="fade-in pt-4">
                    <div className="text-center mb-10">
                        <h2 className="text-xl font-serif text-theme-text">ワクチン管理</h2>
                    </div>
                    <div className="bg-white p-8 rounded-3xl shadow-soft mb-8 text-center relative overflow-hidden">
                        <div className="absolute -top-10 -right-10 w-32 h-32 bg-theme-secondary/10 rounded-full blur-3xl"></div>
                        <label className="block text-[10px] tracking-widest text-theme-text/50 uppercase mb-4">前回の接種日</label>
                        <input type="date" value={lastDate} onChange={handleSave} className="w-full text-center font-serif text-2xl bg-transparent border-b border-theme-secondary/30 pb-2 focus:border-theme-secondary outline-none text-theme-text" />
                    </div>
                    {nextDate ? (
                        <div className="text-center">
                            <p className="text-[10px] tracking-widest text-theme-text/50 uppercase mb-4">次回の予定日</p>
                            <p className="font-serif text-4xl text-theme-secondary mb-4">{nextDate}</p>
                            <span className="inline-block bg-theme-secondary/10 text-theme-secondary px-4 py-1 rounded-full text-xs tracking-wider">
                                あと {Math.floor((new Date(nextDate) - new Date()) / (1000 * 60 * 60 * 24))} 日
                            </span>
                        </div>
                    ) : <p className="text-center text-xs text-theme-text/30 font-sans mt-8">日付を入力してください</p>}
                </div>
            );
        };

        const EventsTab = () => (
            <div className="fade-in pt-4">
                <div className="text-center mb-10">
                    <h2 className="text-xl font-serif text-theme-text">イベント情報</h2>
                </div>
                <div className="space-y-6">
                    {EVENTS_DATA.map((e, i) => (
                        <div key={i} className="bg-white rounded-2xl p-4 shadow-sm flex gap-4 items-center">
                            <img src={e.img} className="w-20 h-20 rounded-xl object-cover grayscale opacity-80" />
                            <div>
                                <span className="text-[10px] font-bold tracking-wider text-theme-primary uppercase">{e.date}</span>
                                <h3 className="font-serif text-lg text-theme-text mb-1">{e.title}</h3>
                                <p className="text-xs text-theme-text/50 font-sans">{e.place}</p>
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        );

        const LostTab = () => (
            <div className="fade-in pt-4">
                <div className="text-center mb-10">
                    <h2 className="text-xl font-serif text-theme-text">迷子情報</h2>
                </div>
                <div className="bg-white p-6 rounded-2xl shadow-soft mb-8">
                    <input type="text" placeholder="情報を共有する..." className="w-full text-sm p-3 mb-4 bg-theme-muted/50 rounded-xl focus:bg-white transition-colors outline-none" />
                    <button className="w-full py-3 bg-theme-text text-white text-xs font-bold tracking-widest uppercase rounded-xl hover:bg-theme-text/80 transition-colors">情報を送信</button>
                </div>
                <div className="space-y-4">
                    {LOST_DATA.map(d => (
                        <div key={d.id} className="flex gap-4 p-4 border-b border-theme-muted items-center">
                            <img src={d.img} className="w-12 h-12 rounded-full object-cover" />
                            <div>
                                <p className="font-serif text-theme-text">{d.name} <span className="text-xs text-theme-text/50 font-sans ml-2">({d.breed})</span></p>
                                <p className="text-xs text-theme-text/40 mt-1">📍 {d.place}</p>
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        );


        // --- MAIN ENTRY POINT ---
        const App = () => {
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            useEffect(() => {
                const session = localStorage.getItem('pepre_isLoggedIn');
                if (session === 'true') setIsLoggedIn(true);
            }, []);
            const handleLogin = () => {
                const confirmLogin = window.confirm("Log in with Google? (Demo)");
                if (confirmLogin) {
                    localStorage.setItem('pepre_isLoggedIn', 'true');
                    setIsLoggedIn(true);
                }
            };
            const handleLogout = () => {
                localStorage.removeItem('pepre_isLoggedIn');
                setIsLoggedIn(false);
            };

            return (
                <div className="w-full max-w-md mx-auto shadow-2xl min-h-screen bg-theme-base overflow-hidden">
                    {isLoggedIn ? <Dashboard onLogout={handleLogout} /> : <LandingPage onLogin={handleLogin} />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>